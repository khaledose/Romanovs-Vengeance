yarefn:
	Inherits: ^BaseBuilding
	Inherits@EXPERIENCE: ^GainsExperience
	Inherits@AUTOTARGET: ^AutoTargetGround
	Inherits@DISK: ^DiskStealable
	Inherits@SHAPE: ^2x2Shape
	Buildable:
		Queue: Building.Shared, Building.Yuri
		BuildPaletteOrder: 30
		Prerequisites: ~building.yuri, power, ~!global-megawealth, ~techlevel.1, ~AIantiRush
		Description: Gathers and processes ore.
		BuildDuration: 750
		BuildDurationModifier: 100
	Valued:
		Cost: 1750
	Tooltip:
	Tooltip@NoRow:
		Name: Slave Miner
	Health:
		HP: 150000
	Armor:
		Type: Medium
	RevealsShroud:
		Range: 6c0
	# RevealsShroudToIntelligenceOwner:
	#	Types: SatelliteScan
	#	Range: 6c0
	RevealOnDeath:
		Radius: 6c0
	ProvidesPrerequisite@yarefn:
		Prerequisite: yarefn
	ProvidesPrerequisite@refinery:
		Prerequisite: refinery
	ProvidesPrerequisite@showslave:
		Prerequisite: showslave
	Building:
		Footprint: xx x+
		Dimensions: 2,2
		TerrainTypes: Clear, Sand, Rough, Dune, Road, DirtRoad
		-SecondaryTerrainTypes:
	SlaveMinerMaster:
		Actors: slav,slav,slav,slav,slav
		Resources: Ore, Gems
		SlaveDisposalOnKill: GiveSlavesToAttacker
		KickDelay: 5
		FreeSound: isl1lia.wav
	Refinery:
		ShowTicks: True
		TickLifetime: 30
		TickVelocity: 1
		TickRate: 10
		UseStorage: false
	DockHost:
		Type: Unload
		DockOffset: 0c725, 0c725, 0
		DockAngle: 120
		MaxQueueLength: 5
	-GivesBuildableArea:
	-Sellable:
	Transforms:
		Facing: 896
		IntoActor: smin
		DeployCursor: undeploy
		Voice: Undeploy
		PauseOnCondition: chronodisable
		# RequiresCondition: !build-incomplete
	TransformsIntoMobile:
		# RequiresCondition: !build-incomplete && !chronodisable
		Locomotor: tracked
		Voice: Move
		RequiresForceMove: false
	TransformsIntoRepairable:
		RequiresCondition: !build-incomplete && !chronodisable
		RepairActors: gadept, nadept, nadepb, caoutp, caoutb
		Voice: Move
		RequiresForceMove: true
	TransformsIntoPassenger:
		RequiresCondition: !build-incomplete && !chronodisable
		CargoType: Vehicle
		Voice: Move
		RequiresForceMove: true
	TransferTimedExternalConditionOnTransform@INVULNERABILITY:
		Condition: invulnerability
	InfiltrateForCash:
		Percentage: 50
		InfiltratedNotification: CashStolen
		InfiltrationNotification: BuildingInfiltratedCashStolen
		Minimum: 500
	WithIdleOverlay@processing:
		Sequence: idle-processing
		PauseOnCondition: chronodisable
		RequiresCondition: !build-incomplete
	Turreted:
		TurnSpeed: 20
		InitialFacing: 128
		Offset: 640,0,0
	Armament@primary:
		Weapon: 20mmrapid
		Damage: 30
		LocalOffset: 512,0,1132
		MuzzleSequence: muzzle
		RequiresCondition: !rank-elite
	Armament@elite:
		Weapon: 20mmrapidE
		Damage: 50
		LocalOffset: 512,0,1132
		MuzzleSequence: muzzle
		RequiresCondition: rank-elite
	AttackTurreted:
		Voice: Attack
		PauseOnCondition: chronodisable
		RequiresCondition: !build-incomplete
	WithMuzzleOverlay:
	RenderSprites:
		Image: yarefn
	RenderVoxels:
		Image: smin
		Scale: 11.7
		LightYaw: 800
		LightPitch: 150
		LightAmbientColor: -0.5,-0.5,-0.5
		LightDiffuseColor: 1.3,1.3,1.3
	WithVoxelTurret:
		RequiresCondition: !build-incomplete
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, Defense, NonGarrisonableStructure, SpyInfiltrate
	Targetable@Water:
		TargetTypes: Ground, Water, WaterStructure, Defense, C4, SpyInfiltrate
	-SpawnActorsOnSell@allies:
	-SpawnActorsOnSell@soviets:
	-SpawnActorsOnSell@psicorps:
	Voiced:
		VoiceSet: SlaveMinerVoice
	Explodes:
		RequiresCondition: !spawn-ore
	Explodes@Ore:
		Type: Footprint
		Weapon: RefineryExplode
		RequiresCondition: spawn-ore
	GrantConditionOnPlayerResources:
		Condition: spawn-ore
	RangedGpsDot:
		Sequence: Harvester
	IsometricSelectable:
		DecorationHeight: 45
