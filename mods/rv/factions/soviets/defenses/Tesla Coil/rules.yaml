tesla:
	Inherits: ^SupportBuilding
	Inherits@AUTOTARGET: ^AutoTargetGround
	Inherits@DRAIN: ^DiskDrainable
	Inherits@LOWPOWER: ^DisableOnLowPowerOrPowerDown
	Inherits@EMPULSE: ^DisabledByEMP
	Inherits@OVERCHARGE: ^AffectedByOvercharge
	Inherits@MC: ^MindControllableBuilding
	Buildable:
		Queue: Support.Shared, Support.Soviets
		BuildPaletteOrder: 60
		Prerequisites: ~building.soviets, naradr, power, ~techlevel.3
		Description: Advanced base defense.\nCan be buffed or made work during low power by Tesla Troopers.\n\n  Strong vs Infantry, Vehicles\n  Weak vs Aircraft\n\nAbilities:\n- Can detect Steath units\n\nUpgradeable with:\n- Overcharge (Russia)\n\n  Requires power to operate.
		BuildDuration: 625
		BuildDurationModifier: 100
	Valued:
		Cost: 1500
	Tooltip:
	Tooltip@NoRow:
		Name: Tesla Coil
	Building:
		Footprint: x
		Dimensions: 1, 1
	Health:
		HP: 60000
	Armor:
		Type: Steel
	RevealsShroud:
		Range: 8c0
	# RevealsShroudToIntelligenceOwner:
	#	Types: SatelliteScan
	#	Range: 8c0
	Targetable@TeslaBoost:
		TargetTypes: TeslaBoost
		RequiresCondition: !powerdown
	WithTeslaChargeOverlay:
	Armament:
		Weapon: CoilBolt
		Damage: 75
		LocalOffset: 0,0,3072
		RequiresCondition: ((!lowpower && !charged) || (lowpower && charged == 1)) && !overcharge
	Armament@charged:
		Weapon: CoilBoltCharged
		Damage: 75
		LocalOffset: 0,0,3072
		RequiresCondition: ((!lowpower && !charged) || (lowpower && charged == 1)) && overcharge
	Armament@1:
		Weapon: OPCoilBolt
		Damage: 100
		LocalOffset: 0,0,3072
		RequiresCondition: ((!lowpower && charged == 1) || (lowpower && charged == 2)) && !overcharge
	Armament@1charged:
		Weapon: OPCoilBoltCharged
		Damage: 100
		LocalOffset: 0,0,3072
		RequiresCondition: ((!lowpower && charged == 1) || (lowpower && charged == 2)) && overcharge
	Armament@2:
		Weapon: OPerCoilBolt
		Damage: 125
		LocalOffset: 0,0,3072
		RequiresCondition: ((!lowpower && charged == 2) || (lowpower && charged >= 3)) && !overcharge
	Armament@2charged:
		Weapon: OPerCoilBoltCharged
		Damage: 125
		LocalOffset: 0,0,3072
		RequiresCondition: ((!lowpower && charged == 2) || (lowpower && charged >= 3)) && overcharge
	Armament@3:
		Weapon: OPestCoilBolt
		Damage: 150
		LocalOffset: 0,0,3072
		RequiresCondition: !lowpower && charged >= 3 && !overcharge
	Armament@3charged:
		Weapon: OPestCoilBoltCharged
		Damage: 150
		LocalOffset: 0,0,3072
		RequiresCondition: !lowpower && charged >= 3 && overcharge
	AttackTesla:
		MaxCharges: 3
		ReloadDelay: 80
		ChargeAudio: btespow.wav
		PauseOnCondition: build-incomplete || disabled || chronodisable
	DetectCloaked:
		Range: 7c0
		RequiresCondition: !disabled
	RenderDetectionCircle:
	AutoTarget:
	WithRangeCircle:
		Range: 8c0
		Type: teslacoil
		RequiresCondition: (!lowpower && !charged) || (lowpower && charged == 1)
	WithRangeCircle@1:
		Range: 8c512
		Type: teslacoil
		RequiresCondition: (!lowpower && charged == 1) || (lowpower && charged == 2)
	WithRangeCircle@2:
		Range: 9c0
		Type: teslacoil
		RequiresCondition: (!lowpower && charged == 2) || (lowpower && charged >= 3)
	WithRangeCircle@3:
		Range: 9c512
		Type: teslacoil
		RequiresCondition: !lowpower && charged >= 3
	Power:
		Amount: -75
		RequiresCondition: !chronodisable
	GrantConditionOnPowerState@LOWPOWER:
		RequiresCondition: !charged
	GrantCondition@IDISABLE:
		RequiresCondition: lowpower || powerdown || emp || diskdrain
	WithIdleOverlay@powered:
		Sequence: idle-powered
		PauseOnCondition: chronodisable
		RequiresCondition: !disabled && !build-incomplete
	ExternalCondition@CHARGED:
		Condition: charged
		SourceCap: 1
	IsometricSelectable:
		Class: tesla
		DecorationHeight: 75
	WithIdleOverlay@waves:
		Sequence: idle-waves
		RequiresCondition: in_water
	Voiced:
		VoiceSet: TeslaCoilVoice
		Volume: 0.8
	ActorStatValues:
		ReloadDelay: 80

