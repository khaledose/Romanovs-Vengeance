yarefn:
	Inherits: ^BaseBuilding
	Inherits@AUTOTARGET: ^AutoTargetGround
	Inherits@DISK: ^DiskStealable
	Inherits@SHAPE: ^2x2Shape
	Buildable:
		Queue: Building.Shared, Building.Yuri
		BuildPaletteOrder: 30
		Prerequisites: ~building.yuri, power, ~!global-megawealth, ~techlevel.1
		Description: Gathers and processes ore.
		BuildDuration: 750
		BuildDurationModifier: 100
	FreeActor@slave1:
		Actor: slav
	FreeActor@slave2:
		Actor: slav
	FreeActor@slave3:
		Actor: slav
	FreeActor@slave4:
		Actor: slav
	FreeActor@slave5:
		Actor: slav
	Valued:
		Cost: 1500
	Tooltip:
	Tooltip@NoRow:
		Name: Slave Miner
	Health:
		HP: 150000
	Armor:
		Type: Medium
	RevealsShroud:
		Range: 6c0
	# RevealsShroudToIntelligenceOwner:
	#	Types: SatelliteScan
	#	Range: 6c0
	RevealOnDeath:
		Radius: 6c0
	ProvidesPrerequisite@yarefn:
		Prerequisite: yarefn
	ProvidesPrerequisite@yarefnorsmin:
		Prerequisite: yarefnorsmin
	ProvidesPrerequisite@psirefn:
		Prerequisite: psirefn
	ProvidesPrerequisite@refinery:
		Prerequisite: refinery
	ProvidesPrerequisite@showslave:
		Prerequisite: showslave
	Building:
		Footprint: xx x+
		Dimensions: 2,2
		TerrainTypes: Clear, Sand, Rough, Dune, Road, DirtRoad
		-SecondaryTerrainTypes:
	Refinery:
		DockOffset: 1,1
		ShowTicks: True
		TickLifetime: 30
		TickVelocity: 1
		TickRate: 10
		DockAngle: 640
		UseStorage: false
	Production@Shared:
		Produces: Infantry.Shared, Slave
		RequiresCondition: !multiqueue
	Production:
		Produces: Infantry.Slave, Slave
		RequiresCondition: multiqueue
	ProductionQueue:
		Type: Infantry.Slave
		Group: Infantry
		LowPowerModifier: 200
		ReadyAudio: UnitReady
		ReadyTextNotification: Unit ready.
		BlockedAudio: NoBuild
		BlockedTextNotification: Unable to build more.
		LimitedAudio: BuildingInProgress
		LimitedTextNotification: Unable to comply. Building in progress.
		QueuedAudio: Training
		OnHoldAudio: OnHold
		CancelledAudio: Cancelled
	ProductionBar@Shared:
		ProductionType: Infantry.Shared
	ProductionBar:
		ProductionType: Infantry.Slave
	GrantConditionOnPrerequisite@multiqueue:
		Condition: multiqueue
		Prerequisites: global-multiqueue
	FreeActor@Dummy:
		Actor: QueueUpdaterDummy
		RequiresCondition: updatequeue
	GrantConditionAfterDelay:
		Delay: 1
		Condition: updatequeue
		ShowSelectionBar: false
	RallyPoint:
		Path: 2,2
	Exit@1Shared:
		SpawnOffset: 0,512,0
		ExitCell: 2, 1
		Facing: 128
		ProductionTypes: Infantry.Shared, Slave
		RequiresCondition: !multiqueue
	Exit@2Shared:
		SpawnOffset: 0,512,0
		ExitCell: 1, 2
		Facing: 128
		ProductionTypes: Infantry.Shared, Slave
		RequiresCondition: !multiqueue
	Exit@1:
		SpawnOffset: 0,512,0
		ExitCell: 2, 1
		Facing: 128
		RequiresCondition: multiqueue
	Exit@2:
		SpawnOffset: 0,512,0
		ExitCell: 1, 2
		Facing: 128
		RequiresCondition: multiqueue
	-GivesBuildableArea:
	Transforms:
		Facing: 896
		IntoActor: smin
		DeployCursor: undeploy
		Voice: Undeploy
		PauseOnCondition: chronodisable
		RequiresCondition: !build-incomplete
	TransformsIntoMobile:
		RequiresCondition: !build-incomplete && !chronodisable
		Locomotor: tracked
		Voice: Move
		RequiresForceMove: true
	TransformsIntoRepairable:
		RequiresCondition: !build-incomplete && !chronodisable
		RepairActors: gadept, nadept, nadepb, yadept, yadepb, caoutp, caoutb
		Voice: Move
		RequiresForceMove: true
	TransformsIntoPassenger:
		RequiresCondition: !build-incomplete && !chronodisable
		CargoType: Vehicle
		Voice: Move
		RequiresForceMove: true
	TransferTimedExternalConditionOnTransform@INVULNERABILITY:
		Condition: invulnerability
	TransferTimedExternalConditionOnTransform@INVISIBILITY:
		Condition: invisibility
	ExternalCondition@INVISIBILITY:
		Condition: invisibility
	InfiltrateForCash:
		Percentage: 50
		InfiltratedNotification: CashStolen
		InfiltrationNotification: BuildingInfiltratedCashStolen
		Minimum: 500
	WithIdleOverlay@processing:
		Sequence: idle-processing
		PauseOnCondition: chronodisable
		RequiresCondition: !build-incomplete
	Turreted:
		TurnSpeed: 20
		InitialFacing: 128
		Offset: 640,0,0
	Armament@primary:
		Weapon: 20mmrapid
		Damage: 30
		LocalOffset: 512,0,1132
		MuzzleSequence: muzzle
	#	RequiresCondition: !rank-elite
	# Armament@elite:
	#	Weapon: 20mmrapidE
	#	Damage: 50
	#	LocalOffset: 512,0,1132
	#	MuzzleSequence: muzzle
	#	RequiresCondition: rank-elite
	AttackTurreted:
		Voice: Attack
		PauseOnCondition: chronodisable
		RequiresCondition: !build-incomplete
	WithMuzzleOverlay:
	RenderSprites:
		Image: yarefn
	RenderVoxels:
		Image: smin
		Scale: 11.7
		LightYaw: 800
		LightPitch: 150
		LightAmbientColor: -0.5,-0.5,-0.5
		LightDiffuseColor: 1.3,1.3,1.3
	WithVoxelTurret:
		RequiresCondition: !build-incomplete
	Targetable:
		TargetTypes: Ground, C4, DetonateAttack, Structure, Defense, NonGarrisonableStructure, SpyInfiltrate
	Targetable@Water:
		TargetTypes: Ground, Water, WaterStructure, Defense, C4, SpyInfiltrate
	-SpawnActorsOnSell@allies:
	-SpawnActorsOnSell@soviets:
	-SpawnActorsOnSell@psicorps:
	Voiced:
		VoiceSet: SlaveMinerVoice
	StoresResources:
		Capacity: 1000
	Explodes:
		RequiresCondition: !spawn-ore
	Explodes@Ore:
		Type: Footprint
		Weapon: RefineryExplode
		RequiresCondition: spawn-ore
	GrantConditionOnPlayerResources:
		Condition: spawn-ore
	RangedGpsDot:
		Sequence: Harvester
	WithResourceStoragePipsDecoration:
		FullSequence: pip-building-yellow
		EmptySequence: pip-building-empty
		Palette: ra
		Margin: 8, 2
		PipStride: 4, 2
		Position: BottomLeft
		RequiresSelection: true
		PipCount: 15
	IsometricSelectable:
		DecorationHeight: 45
